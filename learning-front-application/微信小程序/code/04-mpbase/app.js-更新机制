// app.js
App({
  // onLanch 是小程序的狗子函数，这个狗子函数在冷启动时肯定会执行
  // 当小程序冷启动时，会自动向微信后台请求新版本信息，如果有新版本，会立即进行下载
  onLaunch(){
    // 使用 wx.getUpdateManager 方法监听下载的状态
    const updateManager = wx.getUpdateManager()

    // 当下载完成新版本以后，会触发 onUpdateReady 回调函数
    updateManager.onUpdateReady(function(){
      // 在回调函数中给用户提示，
      wx.showModal({
        title: '更新提示',
        content: '新版本已经准备号，是否重启应用',
        success: (res) => {
          if (res.confirm) {
            // 强制当前小程序使用新版本，并且会启动当前小程序
            updateManager.applyUpdate()
          }
        }
      })
    })

  }

})
