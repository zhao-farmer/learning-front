<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Document</title>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <button id="get">拦截器get</button>
        <script>
            var oget = document.querySelector("#get");

            //设置一个请求拦截器，在请求拦截器中可以对请求参数进行修改
            axios.interceptors.request.use(
                //config：配置对象
                function (config) {
                    console.log("请求拦截器 成功 1号");
                    // config.headers.test = "I am only a header!";
                    //修改 config 中的参数
                    config.params = { a: 100 };
                    return config;
                },
                error => {
                    console.log("请求拦截器 失败 1号");
                    return Promise.reject(error);
                }
            );

            axios.interceptors.request.use(
                function (config) {
                    config.timeout = 5000;
                    console.log("请求拦截器 成功 2号");
                    // config.headers.test = "I am only a header!";
                    //修改 config 中的参数
                    config.timeout = 2000;
                    return config;
                },
                error => {
                    console.log("请求拦截器 失败 2号");
                    return Promise.reject(error);
                }
            );

            //设置一个响应拦截器，可以对响应结果做一些处理
            axios.interceptors.response.use(
                function (response) {
                    console.log("响应拦截器 成功 1号");
                    //返回到请求回调时，只要data数据
                    return response.data;
                },
                function (error) {
                    console.log("响应拦截器 失败 1号");
                    return Promise.reject(error);
                }
            );

            // 拦截器
            oget.onclick = function(){
                axios({
                    method: "GET",
                    url: "http://localhost:3005/users",
                }).then(response => {
                    console.log(response);
                }).catch(reason => {
                    console.log(reason);
                });
            }
           
        </script>
    </body>
</html>
